
<template name="LicensesTable">
  {{> reactiveTable class="table table-bordered table-hover"
      settings=LicensesTableSettings }}
</template>

<template name="spdxLicenseView">
  {{#with getLicenseData spdxid }}
  <strong>{{spdxid}}</strong>
  <ul>
    <li>Name: <a href="{{url}}">{{name}}</a></li>
    <li>osiApproved: {{> LicenseOSI}}</li>
    {{#if category}}<li>Categories: {{category}} </li>{{/if}}
    {{#if limitation}}<li>Limitations: {{limitation}} </li>{{/if}}
    {{#if permission}}<li>Permissions: {{permission}} </li>{{/if}}
    {{#if conditions}}<li>Conditions: {{conditions}} </li>{{/if}}
    {{#if tags}}<li>User Tags: {{tags}}</li>{{/if}}
  </ul>
  {{/with}}
</template>

<template name="quickForm_spdxLicenseForm">
  {{#with atts.doc}}
    <strong>{{spdxid}}</strong>
    <ul>
      <li>Name: <a href="{{url}}">{{name}}</a></li>
      <li>osiApproved: {{> LicenseOSI}}</li>
    {{#if isInRole 'admin,editor'}}
    {{debug this}}
      {{#autoForm id="spdxLicenseForm" type="update" collection="SpdxLicense" doc=this }}
        <li>{{> afQuickField name="limitation" }}</li>
        <li>{{> afQuickField name="conditions" }}</li>
        <li>{{> afQuickField name="permission" }}</li>
        <li>{{> afQuickField name="category" }}</li>
        <li>{{> afQuickField name="tags" }}</li>
      {{/autoForm}}
    {{else}}
      {{#if category}}<li>Categories: {{category}} </li>{{/if}}
      {{#if limitation}}<li>Limitations: {{limitation}} </li>{{/if}}
      {{#if permission}}<li>Permissions: {{permission}} </li>{{/if}}
      {{#if conditions}}<li>Conditions: {{conditions}} </li>{{/if}}
      {{#if tags}}<li>User Tags: {{tags}}</li>{{/if}}
    {{/if}}
  </ul>
  {{/with}}
</template>

<template name="LicenseUrl">
  {{#afModal template="spdxLicenseForm" collection="SpdxLicense" operation="update" doc=_id }}
    {{name}}
  {{/afModal}}
</template>

<template name="LicenseOSI">
  {{#if osiApproved}}
    <i class="fa fa-check-square-o"></i>
  {{else}}
    No
  {{/if}}
</template>

<template name="LicenseTags">
  {{#if currentUser }}
    {{#if editing }}
      <div class="data-category-form">
        {{#autoForm id=(uniqueID "tags") type="update"
            collection="SpdxLicense" doc=this autosaveOnKeyup=true }}
          {{> afQuickField name="tags" label=false }}
        {{/autoForm}}
      </div>
    {{else}}
      <div class="data-category">{{#if tags}}{{tags}}{{else}}&nbsp;{{/if}}</div>
    {{/if}}
  {{else}}
    {{tags}}
  {{/if}}
</template>

<template name="LicenseCategory">
  {{#if isInRole 'admin,editor'}}
    {{#if editing }}
      <div class="data-category-form">
        {{#autoForm id=(uniqueID "category") type="update"
          collection="SpdxLicense" doc=this autosaveOnKeyup=true}}
           {{> afQuickField name="category" label=false }}
        {{/autoForm}}
      </div>
    {{else}}
      <div class="data-category">{{#if category}}{{category}}{{else}}&nbsp;{{/if}}</div>
    {{/if}}
  {{else}}
    {{category}}
  {{/if}}
</template>

<template name="LicenseCommentsSingle">
  {{#if analysis}}<div>Compatibility: {{analysis.compatibility}}</div>{{/if}}
</template>

<template name="LicenseComments">
  <h3>{{commentsBoxTitle}}</h3>

  {{#if sessionGet 'loginAction'}}
    <div class="alert alert-warning" role="alert">You need to login to {{sessionGet 'loginAction'}}</div>
  {{/if}}

  {{#if currentUser }}
    {{#autoForm collection=CommentsCollection id=id role="form" class=(formclass reply)}}
      <div class="form-group">
        {{> afFieldInput name="content" type="textarea"
            label="Comment"
            placeholder=(take key='placeholder-textarea' default='Join the discussion')
            class=(textareaclass reply) rows=3 }}
        {{> afQuickField name="analysis" }}
        <button type="submit" class="btn btn-primary">Submit</button>
      </div>
    {{/autoForm}}
  {{/if}}

  <div class="media-list comments">
    {{#each comment}}
      {{#if analysis}}<div>Compatibility: {{analysis.compatibility}}</div>{{/if}}
      {{> commentsSingleComment }}
    {{/each}}
  </div>

  {{#if hasMoreComments}}
    <button type="button" class="btn btn-success btn-lg btn-block loadmore-action">
      {{ take key='load-more' default='Load more comments' }}
    </button>
  {{/if}}
</template>
